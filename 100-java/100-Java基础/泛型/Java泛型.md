# 1 Java泛型擦除
Java泛型擦除（Type Erasure）是Java语言实现泛型的核心机制，其核心思想是在编译阶段移除泛型类型参数的具体信息，生成的字节码中不保留泛型类型，从而保证与旧版本Java代码的兼容性。以下是具体解析：

### 1.1.1 ​**擦除过程**

- ​**类型替换**：编译器将泛型类型参数替换为其上界类型（默认为`Object`）。例如，`List<String>`和`List<Integer>`在编译后均变为`List`，泛型参数`T`被替换为`Object`。
- ​**插入类型转换**：为确保类型安全，编译器会在必要时自动插入强制类型转换代码。例如，从`List<String>`获取元素时，会插入`(String)`转换。
- ​**生成原始类型**：擦除后，泛型类和方法的原始类型与非泛型版本一致。例如，`Box<T>`编译后变为`Box`，内部字段`T`变为`Object`。

### 1.1.2 ​**设计原因**

- ​**向后兼容性**：Java 5引入泛型时，需确保旧代码（如`ArrayList`）仍能正常运行，避免修改JVM底层机制。
- ​**简化JVM实现**：类型擦除使泛型无需生成额外字节码，沿用原有类加载和运行时机制。

### 1.1.3 ​**局限性**

- ​**运行时类型信息丢失**：无法通过反射获取泛型参数的具体类型（如`List<String>.class`不存在）。
- ​**类型约束失效**：通过反射可绕过泛型限制（如向`List<Integer>`插入`String`对象）。

### 1.1.4 ​**示例验证**

```java
List<String> strList = new ArrayList<>();
List<Integer> intList = new ArrayList<>();
System.out.println(strList.getClass() == intList.getClass()); // 输出 true
```

此代码验证了擦除后`List<String>`和`List<Integer>`的运行时类型均为`List`。

### 1.1.5 总结

Java泛型擦除通过编译时类型替换和自动类型转换实现泛型功能，虽牺牲了运行时类型信息，但通过编译器检查保证了类型安全，同时实现了与旧代码的兼容。