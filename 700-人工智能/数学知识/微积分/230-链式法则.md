链式法则（Chain Rule），是微积分中**求复合函数导数**的基本规则。
简要地说：

> **链式法则描述的是：当一个变量是另一个变量的函数，而这个变量又是另一个变量的函数时，如何求最外层变量相对于最内层变量的导数。**

---

# 1 **一、数学定义**

设有两个函数：
- $y = f(u)$
- $u = g(x)$
则复合函数为 $y = f(g(x))$
**链式法则公式：**
$\frac{dy}{dx} = \frac{dy}{du} \cdot \frac{du}{dx}$
意思是：先求内层函数对 x 的导数，再乘以外层函数对内层的导数。

---

# 2 **二、直观解释**

你可以理解为：
- 假设：你吃的饭影响你的能量$（u）$，能量又影响你的跑步能力$（y）$。
- 那么：跑步能力（y）与吃饭量（x）的关系，就要拆解成：
    - 吃饭量如何影响能量$（du/dx）$
    - 能量如何影响跑步能力$（dy/du）$

合在一起就是：吃饭量如何间接影响跑步能力$（dy/dx）$

---

# 3 **三、举个简单例子**

设：
$y = (3x + 1)^2$
可以看成复合函数：外层是平方函数 $f(u) = u^2$，内层是 $u = 3x + 1$
使用链式法则：
$\frac{dy}{dx} = \frac{dy}{du} \cdot \frac{du}{dx} = 2u \cdot 3 = 2(3x + 1) \cdot 3 = 6(3x + 1)$
你也可以直接展开再求导验证：
$y = (3x + 1)^2 = 9x^2 + 6x + 1 \Rightarrow \frac{dy}{dx} = 18x + 6$
而 $6(3x+1) = 18x + 6$，结果相同。

---

# 4 **四、在机器学习中的应用**

链式法则在神经网络的**反向传播**中起着核心作用。
比如：
- 神经网络的每一层都是前一层的函数
- 要训练模型，就要对损失函数关于权重的偏导数
- 这个过程就需要从输出层一路链式地反推回来
这个过程本质上就是不断应用链式法则。
